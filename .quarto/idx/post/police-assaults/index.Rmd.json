{"title":"Chart: No big changes in sentences after new police-assaults law","markdown":{"yaml":{"title":"Chart: No big changes in sentences after new police-assaults law","author":"Matt Ashby","date":"2020-02-24","slug":"police-assaults","categories":["Crime and justice chart of the week"],"tags":["police","criminal justice","violence"]},"headingText":"custom packages not loaded by helpers.R","containsRefs":false,"markdown":"\n\n```{r set knitr options, include=FALSE}\nknitr::opts_chunk$set(cache = TRUE, include=FALSE)\n```\n\n```{r set chart parameters}\nchart_details <- list(\n\tid = \"police-assaults\",\n\ttitle = \"No big changes in sentences after new police-assaults law\",\n\tsubtitle = \"The government recently doubled the maximum sentence for assaulting a police officer to 12 months in prison, introducing a new offence of assaulting an emergency worker. So far, this change is associated with only small increases in sentences handed down in court.\",\n\tsource_url = \"https://www.gov.uk/government/statistics/criminal-justice-system-statistics-quarterly-september-2019\",\n\tsource_title = \"Ministry of Justice, 2020\"\n)\n```\n\n```{r load packages and helper}\nlibrary(\"cowplot\")\nlibrary(\"ggtext\")\nlibrary(\"lubridate\")\nlibrary(\"readxl\")\n\n# load this after loading custom packages\nsource(here::here(\"helpers.R\"))\n```\n\n```{r get and tidy data}\nif (!file.exists(paste0(chart_details$id, \"-data.csv.gz\"))) {\n\t\n\t# download most-recent data\n\tdata_file <- tempfile(fileext = \".xlsx\")\n\tGET(\"https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/866997/emergency-workers-table-sept-2019.xlsx\", write_disk(data_file))\n\t\n\t# read data and tidy\n\ttidy_data <- read_excel(data_file, \"Table\", skip = 3, na = \"*\") %>% \n\t\tjanitor::clean_names() %>% \n\t\tslice(1:48) %>% \n\t\tremove_empty(\"cols\") %>% \n\t\t# colnames have been jumbled by clean_names(), so just set them all\n\t\tmagrittr::set_colnames(c(\n\t\t\t\"offence\", \n\t\t\tformat(seq.Date(ymd(\"2018-01-01\"), ymd(\"2019-09-01\"), by = \"month\"), \n\t\t\t\t\t\t \"%Y_%m\")\n\t\t)) %>% \n\t\t# identify rows that contain only headers\n\t\tmutate(sentence = ifelse(is.na(`2019_09`), offence, NA_character_)) %>% \n\t\t# fill headers down\n\t\tfill(sentence, .direction = \"down\") %>% \n\t\t# remove rows that contain only headers\n\t\tfilter(!is.na(`2019_09`)) %>% \n\t\t# move header col to left\n\t\tselect(sentence, offence, everything()) %>% \n\t\tpivot_longer(c(-sentence, -offence), names_to = \"month\", \n\t\t\t\t\t\t\t\t values_to = \"count\") %>% \n\t\tmutate(month = as_date(paste(month, \"01\"), format = \"%Y_%m %d\", tz = \"UTC\"))\n\t\t\n\t# save tidy data\n\twrite_csv(tidy_data, paste0(chart_details$id, \"-data.csv.gz\"))\t\n\t\n} else {\n\t\n\t# load tidy data\n\ttidy_data <- read_csv(paste0(chart_details$id, \"-data.csv.gz\"))\n\t\n}\n```\n\n```{r prepare data for chart}\nchart_data_a <- tidy_data %>% \n\tfilter(\n\t\t!sentence %in% c(\"Prosecuted\", \"Convicted\", \"Sentenced\", \n\t\t\t\t\t\t\t\t\t\t \"Average custodial sentence length (months)\"),\n\t\toffence != \"Common assault and battery\"\n\t) %>% \n\tmutate(custody = sentence == \"Immediate custody\") %>% \n\tcount(custody, month, wt = count) %>% \n\tgroup_by(month) %>% \n\tmutate(prop = n / sum(n)) %>% \n\tfilter(custody == TRUE) %>% \n\tselect(-custody)\n\nchart_data_b <- tidy_data %>%\n\tfilter(\n\t\tsentence == \"Average custodial sentence length (months)\",\n\t\toffence != \"Common assault and battery\"\n\t) %>%\n\tselect(offence, month, days = count) %>%\n\tmutate(\n\t\tdays = ifelse(\n\t\t\tdays == 0 |\n\t\t\t\t(offence == \"Assault on a constable\" & month > ymd(\"2019-03-01\")),\n\t\t\tNA,\n\t\t\tdays * 28\n\t\t),\n\t\toffence = str_to_lower(offence)\n\t) %>%\n\tremove_missing(na.rm = TRUE)\n\n# add chart labels\nchart_labels_a <- tribble(\n\t~x, ~y, ~xend, ~yend, ~label, ~hjust, ~vjust, ~curve,\n\tymd(\"2018-01-01\"), 0.002, ymd(\"2018-01-01\"), 0.002, balance_lines(\"without a comparison group it isn't possible to say if these differences were due to the new law or to other factors (e.g. long-term trends in sentencing) that were happening at the same time\", 4), \"left\", \"bottom\", \"none\",\n\tymd(\"2018-11-10\"), 0.075, ymd(\"2019-01-01\"), 0.075, balance_lines(\"longer sentences were introduced in November 2018\", 3), \"left\", \"center\", \"right\",\n\tymd(\"2018-09-01\"), 0.1325, ymd(\"2018-09-01\"), 0.11, balance_lines(\"the likelihood of going to prison may have already been rising before the new law applied, so any increase might not be due to the legal change\", 8), \"right\", \"top\", \"left\"\n)\nchart_labels_b <- tribble(\n\t~x, ~y, ~xend, ~yend, ~label, ~hjust, ~vjust, ~curve,\n\tymd(\"2019-02-01\"), 62, ymd(\"2019-02-01\"), 45, balance_lines(\"some people were sentenced under the old law even after the change\", 3), \"right\", \"top\", \"left\",\n\tymd(\"2019-09-01\"), 1, ymd(\"2019-08-01\"), 10, balance_lines(\"only 10 months of data are available after the new law was introduced – as time passes, more data may show a different picture\", 3), \"right\", \"center\", \"right\"\n\t# ymd(\"2019-06-15\"), 73.5, ymd(\"2019-06-15\"), 21, balance_lines(\"prison sentences under the new law are on average about 13 days longer than under the old law\", 4), \"right\", \"top\", \"left\"\n)\n```\n\n```{r build plot}\nchart_a <- ggplot(chart_data_a, aes(month, prop)) +\n\tgeom_vline(aes(xintercept = ymd(\"2018-11-01\")), \n\t\t\t\t\t\t colour = elements$average_line_colour, \n\t\t\t\t\t\t linetype = elements$average_line_linetype) +\n\tgeom_point(colour = ucl_colours_list[[\"Bright Red\"]], size = 0.75, \n\t\t\t\t\t\t alpha = 0.67) +\n\tgeom_smooth(method = \"loess\", formula = \"y ~ x\", se = FALSE, \n\t\t\t\t\t\t\tcolour = ucl_colours_list[[\"Bright Red\"]]) +\n\t# add explanatory labels\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_a, curve == \"right\"), \n\t\t\t\t\t\t inherit.aes = FALSE, curvature = elements$label_line_curvature, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_segment(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_a, curve == \"straight\"), \n\t\t\t\t\t\t inherit.aes = FALSE, colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_a, curve == \"left\"), inherit.aes = FALSE, \n\t\t\t\t\t\t curvature = elements$label_line_curvature * -1, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_label(aes(x = xend, y = yend, label = label, hjust = hjust, \n\t\t\t\t\t\t\t\t vjust = vjust),\n\t\t\t\t\t\tdata = chart_labels_a, inherit.aes = FALSE, \n\t\t\t\t\t\tcolour = elements$label_text_colour,\n\t\t\t\t\t\tfill = elements$label_text_fill, size = elements$label_text_size, \n\t\t\t\t\t\tlineheight = elements$label_text_lineheight,\n\t\t\t\t\t\tlabel.size = NA, show.legend = FALSE) +\n\t# end of explanatory labels\n\tscale_x_date(date_breaks = \"6 months\", date_labels = \"%b '%y\", \n\t\t\t\t\t\t\t expand = expansion(mult = 0.02)) +\n\tscale_y_continuous(expand = expansion(mult = c(0, 0.02)), limits = c(0, NA),\n\t\t\t\t\t\t\t\t\t\t labels = scales::percent_format(accuracy = 1)) +\n\tlabs(\n\t\ttitle = \"there has been about a three percentage-point increase in the chance of going to prison …\",\n\t\tlegend = NULL,\n\t\tx = NULL,\n\t\ty = \"proportion of convicted offenders sent to prison   \"\n\t) +\n\ttheme_cjcharts() +\n\ttheme() +\n\ttheme(\n\t\tplot.margin = unit(c(6, 6, 0, 0), \"pt\"),\n\t\tplot.title = element_textbox_simple(\n\t\t\tsize = 10, \n\t\t\tcolour = ucl_colours_list[[\"Bright Red\"]]\n\t\t),\n\t\tplot.title.position = \"plot\"\n\t)\n\nchart_b <- ggplot(chart_data_b, aes(month, days, colour = offence, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgroup = offence)) +\n\tgeom_vline(aes(xintercept = ymd(\"2018-11-01\")), \n\t\t\t\t\t\t colour = elements$average_line_colour, \n\t\t\t\t\t\t linetype = elements$average_line_linetype) +\n\tgeom_point(size = 0.75, alpha = 0.67) +\n\tgeom_smooth(method = \"lm\", formula = \"y ~ x\", se = FALSE) +\n\t# add explanatory labels\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_b, curve == \"right\"), \n\t\t\t\t\t\t inherit.aes = FALSE, curvature = elements$label_line_curvature, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_segment(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_b, curve == \"straight\"), \n\t\t\t\t\t\t inherit.aes = FALSE, colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_b, curve == \"left\"), inherit.aes = FALSE, \n\t\t\t\t\t\t curvature = elements$label_line_curvature * -1, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_label(aes(x = xend, y = yend, label = label, hjust = hjust, \n\t\t\t\t\t\t\t\t vjust = vjust),\n\t\t\t\t\t\tdata = chart_labels_b, inherit.aes = FALSE, \n\t\t\t\t\t\tcolour = elements$label_text_colour,\n\t\t\t\t\t\tfill = elements$label_text_fill, size = elements$label_text_size, \n\t\t\t\t\t\tlineheight = elements$label_text_lineheight,\n\t\t\t\t\t\tlabel.size = NA, show.legend = FALSE) +\n\t# end of explanatory labels\n\tscale_x_date(date_breaks = \"6 months\", date_labels = \"%b '%y\", \n\t\t\t\t\t\t\t expand = expansion(mult = 0.02)) +\n\tscale_y_continuous(expand = expansion(mult = c(0, 0.02)), limits = c(0, NA)) +\n\tscale_colour_manual(\n\t\tvalues = unname(ucl_colours_list[c(\"Bright Blue\", \"Mid Blue\")])\n\t) +\n\tlabs(\n\t\ttitle = \"… and those given prison sentences are given about 10 days longer\",\n\t\tlegend = NULL,\n\t\tx = NULL,\n\t\ty = \"average days of imprisonment   \"\n\t) +\n\ttheme_cjcharts() +\n\ttheme(\n\t\tlegend.position = \"none\",\n\t\tplot.margin = unit(c(6, 0, 0, 6), \"pt\"),\n\t\tplot.title = element_textbox_simple(\n\t\t\tsize = 10, \n\t\t\tcolour = ucl_colours_list[[\"Bright Blue\"]]\n\t\t),\n\t\tplot.title.position = \"plot\"\n\t)\n\nchart <- plot_grid(\n\t\tchart_a, \n\t\tchart_b, \n\t\talign = \"h\"\n\t)\n```\n\n\n`r chart_details$subtitle`\n\n```{r display plot, echo=FALSE, include=TRUE}\nadd_logo(chart, chart_details$source_title, chart_details$id)\n```\n\n[larger image](../`r chart_details$id`.png)\n| [annotated R code to produce this chart](https://github.com/mpjashby/lesscrime.info/blob/master/content/post/`r chart_details$id`.Rmd)\n\nData source: [`r chart_details$source_title`](`r chart_details$source_url`)\n\n### Notes\n\nTo test whether there were any differences between imprisonment probability or sentence length before and after the new law was introduced, I ran separate ARIMA regression models (using the `auto.arima()` function in the [`forecast`](http://pkg.robjhyndman.com/forecast) R package) on the monthly probability of being imprisoned for assaulting police and on the average length of prison sentences. Each model included a variable that was set to false for months before the new law was introduced and true for months afterwards. If these variables were statistically significant (i.e. $p < 0.05$) we can say there is a difference in either imprisonment probability or imprisonment length after the law was introduced.\n\n```{r model changes}\nchart_model_a <- forecast::auto.arima(\n\tchart_data_a$prop,\n\txreg = as.numeric(chart_data_a$month >= ymd(\"2018-11-01\"))\n)\n\nchart_model_b <- forecast::auto.arima(\n\tchart_data_b$days,\n\txreg = as.numeric(chart_data_b$month >= ymd(\"2018-11-01\"))\n)\n```\n\nThe first model assessed whether the new law was associated with any change in the probability of being imprisoned on conviction for assaulting a police officer. This table shows that there was a small, but statistically significant, increase in the probability of being imprisoned after the new law came into effect.\n\n```{r report model A, echo=FALSE, include=TRUE}\ntibble(\n\tvariable = names(chart_model_a$coef),\n\testimate = chart_model_a$coef,\n\t`standard error` = sqrt(diag(chart_model_a$var.coef)),\n\t`p value` = scales::pvalue((1 - pnorm(abs(estimate) / `standard error`))\t* 2)\n) %>% \n\tmutate(\n\t\tvariable = recode_factor(variable, intercept = \"intercept\", ar1 = \"AR(1)\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t xreg = \"after new law passed\")\n\t) %>% \n\tmutate_if(is.numeric, scales::comma, accuracy = 0.001) %>% \n\tarrange(variable) %>% \n\tknitr::kable(align = c(\"l\", \"r\", \"r\", \"r\"))\n```\n\nThe second model assessed whether the new law was associated with any change in the number of days imprisonment that people were sentenced to, if they were sent to prison for assaulting police. This table shows there was another small, but again statistically significant, increase in sentence length.\n\n```{r report model B, echo=FALSE, include=TRUE}\ntibble(\n\tvariable = names(chart_model_b$coef),\n\testimate = chart_model_b$coef,\n\t`standard error` = sqrt(diag(chart_model_b$var.coef)),\n\t`p value` = scales::pvalue((1 - pnorm(abs(estimate) / `standard error`))\t* 2)\n) %>% \n\tmutate(\n\t\tvariable = recode_factor(variable, intercept = \"intercept\", \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t xreg = \"after new law passed\")\n\t) %>% \n\tmutate_if(is.numeric, scales::comma, accuracy = 0.1) %>% \n\tarrange(variable) %>% \n\tknitr::kable(align = c(\"l\", \"r\", \"r\", \"r\"))\n```\n\nBoth these models are limited, because there are no comparison groups against which to compare the differences observed. This means it is not possible to estimate how likely it is that any differences are due to the new law or to other factors (such as long-term trends in sentencing practice) that were happening at the same time.\n\n\n```{r export chart, eval=FALSE}\n# save PNG for social media\nggsave(\n\tfilename = paste0(chart_details$id, \".png\"), \n\tplot = add_logo(\n\t\tplot_grid(\n\t\t\tggdraw() + \n\t\t\t\tdraw_label(chart_details$title, x = 0, hjust = 0, fontface = \"bold\", \n\t\t\t\t\t\t\t\t\t size = 16),\n\t\t\tggdraw() +\n\t\t\t\tdraw_label(format_subtitle(chart_details$subtitle, .width = 90), x = 0, \n\t\t\t\t\t\t\t\t\t hjust = 0, fontface = \"plain\", size = 12),\n\t\t\tchart,\n\t\t\tncol = 1,\n\t\t\trel_heights = c(0.04, 0.16, 0.8)\n\t\t), \n\t\tchart_details$source_title, \n\t\tchart_details$id\n\t), \n\tdevice = \"png\", width = 600 / 72, height = 400 / 72, units = \"in\"\n)\n```\n","srcMarkdownNoYaml":"\n\n```{r set knitr options, include=FALSE}\nknitr::opts_chunk$set(cache = TRUE, include=FALSE)\n```\n\n```{r set chart parameters}\nchart_details <- list(\n\tid = \"police-assaults\",\n\ttitle = \"No big changes in sentences after new police-assaults law\",\n\tsubtitle = \"The government recently doubled the maximum sentence for assaulting a police officer to 12 months in prison, introducing a new offence of assaulting an emergency worker. So far, this change is associated with only small increases in sentences handed down in court.\",\n\tsource_url = \"https://www.gov.uk/government/statistics/criminal-justice-system-statistics-quarterly-september-2019\",\n\tsource_title = \"Ministry of Justice, 2020\"\n)\n```\n\n```{r load packages and helper}\n# custom packages not loaded by helpers.R\nlibrary(\"cowplot\")\nlibrary(\"ggtext\")\nlibrary(\"lubridate\")\nlibrary(\"readxl\")\n\n# load this after loading custom packages\nsource(here::here(\"helpers.R\"))\n```\n\n```{r get and tidy data}\nif (!file.exists(paste0(chart_details$id, \"-data.csv.gz\"))) {\n\t\n\t# download most-recent data\n\tdata_file <- tempfile(fileext = \".xlsx\")\n\tGET(\"https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/866997/emergency-workers-table-sept-2019.xlsx\", write_disk(data_file))\n\t\n\t# read data and tidy\n\ttidy_data <- read_excel(data_file, \"Table\", skip = 3, na = \"*\") %>% \n\t\tjanitor::clean_names() %>% \n\t\tslice(1:48) %>% \n\t\tremove_empty(\"cols\") %>% \n\t\t# colnames have been jumbled by clean_names(), so just set them all\n\t\tmagrittr::set_colnames(c(\n\t\t\t\"offence\", \n\t\t\tformat(seq.Date(ymd(\"2018-01-01\"), ymd(\"2019-09-01\"), by = \"month\"), \n\t\t\t\t\t\t \"%Y_%m\")\n\t\t)) %>% \n\t\t# identify rows that contain only headers\n\t\tmutate(sentence = ifelse(is.na(`2019_09`), offence, NA_character_)) %>% \n\t\t# fill headers down\n\t\tfill(sentence, .direction = \"down\") %>% \n\t\t# remove rows that contain only headers\n\t\tfilter(!is.na(`2019_09`)) %>% \n\t\t# move header col to left\n\t\tselect(sentence, offence, everything()) %>% \n\t\tpivot_longer(c(-sentence, -offence), names_to = \"month\", \n\t\t\t\t\t\t\t\t values_to = \"count\") %>% \n\t\tmutate(month = as_date(paste(month, \"01\"), format = \"%Y_%m %d\", tz = \"UTC\"))\n\t\t\n\t# save tidy data\n\twrite_csv(tidy_data, paste0(chart_details$id, \"-data.csv.gz\"))\t\n\t\n} else {\n\t\n\t# load tidy data\n\ttidy_data <- read_csv(paste0(chart_details$id, \"-data.csv.gz\"))\n\t\n}\n```\n\n```{r prepare data for chart}\nchart_data_a <- tidy_data %>% \n\tfilter(\n\t\t!sentence %in% c(\"Prosecuted\", \"Convicted\", \"Sentenced\", \n\t\t\t\t\t\t\t\t\t\t \"Average custodial sentence length (months)\"),\n\t\toffence != \"Common assault and battery\"\n\t) %>% \n\tmutate(custody = sentence == \"Immediate custody\") %>% \n\tcount(custody, month, wt = count) %>% \n\tgroup_by(month) %>% \n\tmutate(prop = n / sum(n)) %>% \n\tfilter(custody == TRUE) %>% \n\tselect(-custody)\n\nchart_data_b <- tidy_data %>%\n\tfilter(\n\t\tsentence == \"Average custodial sentence length (months)\",\n\t\toffence != \"Common assault and battery\"\n\t) %>%\n\tselect(offence, month, days = count) %>%\n\tmutate(\n\t\tdays = ifelse(\n\t\t\tdays == 0 |\n\t\t\t\t(offence == \"Assault on a constable\" & month > ymd(\"2019-03-01\")),\n\t\t\tNA,\n\t\t\tdays * 28\n\t\t),\n\t\toffence = str_to_lower(offence)\n\t) %>%\n\tremove_missing(na.rm = TRUE)\n\n# add chart labels\nchart_labels_a <- tribble(\n\t~x, ~y, ~xend, ~yend, ~label, ~hjust, ~vjust, ~curve,\n\tymd(\"2018-01-01\"), 0.002, ymd(\"2018-01-01\"), 0.002, balance_lines(\"without a comparison group it isn't possible to say if these differences were due to the new law or to other factors (e.g. long-term trends in sentencing) that were happening at the same time\", 4), \"left\", \"bottom\", \"none\",\n\tymd(\"2018-11-10\"), 0.075, ymd(\"2019-01-01\"), 0.075, balance_lines(\"longer sentences were introduced in November 2018\", 3), \"left\", \"center\", \"right\",\n\tymd(\"2018-09-01\"), 0.1325, ymd(\"2018-09-01\"), 0.11, balance_lines(\"the likelihood of going to prison may have already been rising before the new law applied, so any increase might not be due to the legal change\", 8), \"right\", \"top\", \"left\"\n)\nchart_labels_b <- tribble(\n\t~x, ~y, ~xend, ~yend, ~label, ~hjust, ~vjust, ~curve,\n\tymd(\"2019-02-01\"), 62, ymd(\"2019-02-01\"), 45, balance_lines(\"some people were sentenced under the old law even after the change\", 3), \"right\", \"top\", \"left\",\n\tymd(\"2019-09-01\"), 1, ymd(\"2019-08-01\"), 10, balance_lines(\"only 10 months of data are available after the new law was introduced – as time passes, more data may show a different picture\", 3), \"right\", \"center\", \"right\"\n\t# ymd(\"2019-06-15\"), 73.5, ymd(\"2019-06-15\"), 21, balance_lines(\"prison sentences under the new law are on average about 13 days longer than under the old law\", 4), \"right\", \"top\", \"left\"\n)\n```\n\n```{r build plot}\nchart_a <- ggplot(chart_data_a, aes(month, prop)) +\n\tgeom_vline(aes(xintercept = ymd(\"2018-11-01\")), \n\t\t\t\t\t\t colour = elements$average_line_colour, \n\t\t\t\t\t\t linetype = elements$average_line_linetype) +\n\tgeom_point(colour = ucl_colours_list[[\"Bright Red\"]], size = 0.75, \n\t\t\t\t\t\t alpha = 0.67) +\n\tgeom_smooth(method = \"loess\", formula = \"y ~ x\", se = FALSE, \n\t\t\t\t\t\t\tcolour = ucl_colours_list[[\"Bright Red\"]]) +\n\t# add explanatory labels\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_a, curve == \"right\"), \n\t\t\t\t\t\t inherit.aes = FALSE, curvature = elements$label_line_curvature, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_segment(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_a, curve == \"straight\"), \n\t\t\t\t\t\t inherit.aes = FALSE, colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_a, curve == \"left\"), inherit.aes = FALSE, \n\t\t\t\t\t\t curvature = elements$label_line_curvature * -1, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_label(aes(x = xend, y = yend, label = label, hjust = hjust, \n\t\t\t\t\t\t\t\t vjust = vjust),\n\t\t\t\t\t\tdata = chart_labels_a, inherit.aes = FALSE, \n\t\t\t\t\t\tcolour = elements$label_text_colour,\n\t\t\t\t\t\tfill = elements$label_text_fill, size = elements$label_text_size, \n\t\t\t\t\t\tlineheight = elements$label_text_lineheight,\n\t\t\t\t\t\tlabel.size = NA, show.legend = FALSE) +\n\t# end of explanatory labels\n\tscale_x_date(date_breaks = \"6 months\", date_labels = \"%b '%y\", \n\t\t\t\t\t\t\t expand = expansion(mult = 0.02)) +\n\tscale_y_continuous(expand = expansion(mult = c(0, 0.02)), limits = c(0, NA),\n\t\t\t\t\t\t\t\t\t\t labels = scales::percent_format(accuracy = 1)) +\n\tlabs(\n\t\ttitle = \"there has been about a three percentage-point increase in the chance of going to prison …\",\n\t\tlegend = NULL,\n\t\tx = NULL,\n\t\ty = \"proportion of convicted offenders sent to prison   \"\n\t) +\n\ttheme_cjcharts() +\n\ttheme() +\n\ttheme(\n\t\tplot.margin = unit(c(6, 6, 0, 0), \"pt\"),\n\t\tplot.title = element_textbox_simple(\n\t\t\tsize = 10, \n\t\t\tcolour = ucl_colours_list[[\"Bright Red\"]]\n\t\t),\n\t\tplot.title.position = \"plot\"\n\t)\n\nchart_b <- ggplot(chart_data_b, aes(month, days, colour = offence, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgroup = offence)) +\n\tgeom_vline(aes(xintercept = ymd(\"2018-11-01\")), \n\t\t\t\t\t\t colour = elements$average_line_colour, \n\t\t\t\t\t\t linetype = elements$average_line_linetype) +\n\tgeom_point(size = 0.75, alpha = 0.67) +\n\tgeom_smooth(method = \"lm\", formula = \"y ~ x\", se = FALSE) +\n\t# add explanatory labels\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_b, curve == \"right\"), \n\t\t\t\t\t\t inherit.aes = FALSE, curvature = elements$label_line_curvature, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_segment(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_b, curve == \"straight\"), \n\t\t\t\t\t\t inherit.aes = FALSE, colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_curve(aes(x = x, y = y, xend = xend, yend = yend),\n\t\t\t\t\t\t data = filter(chart_labels_b, curve == \"left\"), inherit.aes = FALSE, \n\t\t\t\t\t\t curvature = elements$label_line_curvature * -1, \n\t\t\t\t\t\t colour = elements$label_line_colour, \n\t\t\t\t\t\t arrow = elements$label_arrow, show.legend = FALSE) +\n\tgeom_label(aes(x = xend, y = yend, label = label, hjust = hjust, \n\t\t\t\t\t\t\t\t vjust = vjust),\n\t\t\t\t\t\tdata = chart_labels_b, inherit.aes = FALSE, \n\t\t\t\t\t\tcolour = elements$label_text_colour,\n\t\t\t\t\t\tfill = elements$label_text_fill, size = elements$label_text_size, \n\t\t\t\t\t\tlineheight = elements$label_text_lineheight,\n\t\t\t\t\t\tlabel.size = NA, show.legend = FALSE) +\n\t# end of explanatory labels\n\tscale_x_date(date_breaks = \"6 months\", date_labels = \"%b '%y\", \n\t\t\t\t\t\t\t expand = expansion(mult = 0.02)) +\n\tscale_y_continuous(expand = expansion(mult = c(0, 0.02)), limits = c(0, NA)) +\n\tscale_colour_manual(\n\t\tvalues = unname(ucl_colours_list[c(\"Bright Blue\", \"Mid Blue\")])\n\t) +\n\tlabs(\n\t\ttitle = \"… and those given prison sentences are given about 10 days longer\",\n\t\tlegend = NULL,\n\t\tx = NULL,\n\t\ty = \"average days of imprisonment   \"\n\t) +\n\ttheme_cjcharts() +\n\ttheme(\n\t\tlegend.position = \"none\",\n\t\tplot.margin = unit(c(6, 0, 0, 6), \"pt\"),\n\t\tplot.title = element_textbox_simple(\n\t\t\tsize = 10, \n\t\t\tcolour = ucl_colours_list[[\"Bright Blue\"]]\n\t\t),\n\t\tplot.title.position = \"plot\"\n\t)\n\nchart <- plot_grid(\n\t\tchart_a, \n\t\tchart_b, \n\t\talign = \"h\"\n\t)\n```\n\n\n`r chart_details$subtitle`\n\n```{r display plot, echo=FALSE, include=TRUE}\nadd_logo(chart, chart_details$source_title, chart_details$id)\n```\n\n[larger image](../`r chart_details$id`.png)\n| [annotated R code to produce this chart](https://github.com/mpjashby/lesscrime.info/blob/master/content/post/`r chart_details$id`.Rmd)\n\nData source: [`r chart_details$source_title`](`r chart_details$source_url`)\n\n### Notes\n\nTo test whether there were any differences between imprisonment probability or sentence length before and after the new law was introduced, I ran separate ARIMA regression models (using the `auto.arima()` function in the [`forecast`](http://pkg.robjhyndman.com/forecast) R package) on the monthly probability of being imprisoned for assaulting police and on the average length of prison sentences. Each model included a variable that was set to false for months before the new law was introduced and true for months afterwards. If these variables were statistically significant (i.e. $p < 0.05$) we can say there is a difference in either imprisonment probability or imprisonment length after the law was introduced.\n\n```{r model changes}\nchart_model_a <- forecast::auto.arima(\n\tchart_data_a$prop,\n\txreg = as.numeric(chart_data_a$month >= ymd(\"2018-11-01\"))\n)\n\nchart_model_b <- forecast::auto.arima(\n\tchart_data_b$days,\n\txreg = as.numeric(chart_data_b$month >= ymd(\"2018-11-01\"))\n)\n```\n\nThe first model assessed whether the new law was associated with any change in the probability of being imprisoned on conviction for assaulting a police officer. This table shows that there was a small, but statistically significant, increase in the probability of being imprisoned after the new law came into effect.\n\n```{r report model A, echo=FALSE, include=TRUE}\ntibble(\n\tvariable = names(chart_model_a$coef),\n\testimate = chart_model_a$coef,\n\t`standard error` = sqrt(diag(chart_model_a$var.coef)),\n\t`p value` = scales::pvalue((1 - pnorm(abs(estimate) / `standard error`))\t* 2)\n) %>% \n\tmutate(\n\t\tvariable = recode_factor(variable, intercept = \"intercept\", ar1 = \"AR(1)\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t xreg = \"after new law passed\")\n\t) %>% \n\tmutate_if(is.numeric, scales::comma, accuracy = 0.001) %>% \n\tarrange(variable) %>% \n\tknitr::kable(align = c(\"l\", \"r\", \"r\", \"r\"))\n```\n\nThe second model assessed whether the new law was associated with any change in the number of days imprisonment that people were sentenced to, if they were sent to prison for assaulting police. This table shows there was another small, but again statistically significant, increase in sentence length.\n\n```{r report model B, echo=FALSE, include=TRUE}\ntibble(\n\tvariable = names(chart_model_b$coef),\n\testimate = chart_model_b$coef,\n\t`standard error` = sqrt(diag(chart_model_b$var.coef)),\n\t`p value` = scales::pvalue((1 - pnorm(abs(estimate) / `standard error`))\t* 2)\n) %>% \n\tmutate(\n\t\tvariable = recode_factor(variable, intercept = \"intercept\", \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t xreg = \"after new law passed\")\n\t) %>% \n\tmutate_if(is.numeric, scales::comma, accuracy = 0.1) %>% \n\tarrange(variable) %>% \n\tknitr::kable(align = c(\"l\", \"r\", \"r\", \"r\"))\n```\n\nBoth these models are limited, because there are no comparison groups against which to compare the differences observed. This means it is not possible to estimate how likely it is that any differences are due to the new law or to other factors (such as long-term trends in sentencing practice) that were happening at the same time.\n\n\n```{r export chart, eval=FALSE}\n# save PNG for social media\nggsave(\n\tfilename = paste0(chart_details$id, \".png\"), \n\tplot = add_logo(\n\t\tplot_grid(\n\t\t\tggdraw() + \n\t\t\t\tdraw_label(chart_details$title, x = 0, hjust = 0, fontface = \"bold\", \n\t\t\t\t\t\t\t\t\t size = 16),\n\t\t\tggdraw() +\n\t\t\t\tdraw_label(format_subtitle(chart_details$subtitle, .width = 90), x = 0, \n\t\t\t\t\t\t\t\t\t hjust = 0, fontface = \"plain\", size = 12),\n\t\t\tchart,\n\t\t\tncol = 1,\n\t\t\trel_heights = c(0.04, 0.16, 0.8)\n\t\t), \n\t\tchart_details$source_title, \n\t\tchart_details$id\n\t), \n\tdevice = \"png\", width = 600 / 72, height = 400 / 72, units = \"in\"\n)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.40","author":[{"name":"Matt Ashby"},"Matt Ashby"],"theme":["sandstone","../../custom.scss"],"date-format":"D MMM YYYY","title":"Chart: No big changes in sentences after new police-assaults law","date":"2020-02-24","slug":"police-assaults","categories":["Crime and justice chart of the week"],"tags":["police","criminal justice","violence"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}